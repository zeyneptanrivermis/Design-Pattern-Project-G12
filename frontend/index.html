<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Envanter Y√∂netim Sistemi (Etkile≈üimli Frontend)</title>
    <link rel="stylesheet" href="style.css"> 
</head>
<body>
    <header>
        <h1>‚ú® Envanter Y√∂netim Sistemi (Sim√ºlasyon) ‚ú®</h1>
        <p>Tasarƒ±m Desenleri ile Geli≈ütirilmi≈ütir (6 Desen Entegre)</p>
    </header>

    <div class="container">
        
        <aside class="menu">
            <h2>‚öôÔ∏è ƒ∞≈ülem Men√ºs√º (Frontend)</h2>
            <p class="explanation">Bu aray√ºz, Backend (Java Console) i≈ülemlerini sim√ºle eder ve √ßƒ±ktƒ±larƒ± listeler.</p>
            <div id="backend-output">
                <p class="info-message">Sistem Hazƒ±r. Bir i≈ülem se√ßiniz.</p>
            </div>
            
            <button onclick="handleMenu(1, 'Yeni Kategori Ekle')">1. Yeni Kategori Ekle</button>
            <button onclick="handleMenu(2, 'Yeni √úr√ºn Ekle (Builder)')">2. Yeni √úr√ºn Ekle (Builder)</button>
            <button onclick="handleMenu(3, '√úr√ºn/Stok/Fiyat G√ºncelle')">3. √úr√ºn/Stok/Fiyat G√ºncelle</button>
            <button onclick="handleMenu(4, 'T√ºm Kataloƒüu G√∂r√ºnt√ºle')">4. T√ºm Kataloƒüu G√∂r√ºnt√ºle</button>
            <button onclick="handleMenu(5, 'Fiyatlandƒ±rma Stratejisi Deƒüi≈ütir')">5. Fiyatlandƒ±rma Stratejisi Deƒüi≈ütir (Strategy)</button>
            <button onclick="handleMenu(6, 'D√º≈ü√ºk Stok E≈üiƒüi G√ºncelle')">6. D√º≈ü√ºk Stok E≈üiƒüi G√ºncelle (Singleton)</button>
            <button onclick="handleMenu(7, '√úr√ºn Sil')">7. √úr√ºn Sil</button>
            <button onclick="handleMenu(8, 'Kategori Sil')">8. Kategori Sil</button>
            <button onclick="handleMenu(9, '√áƒ±kƒ±≈ü')">9. √áƒ±kƒ±≈ü</button>
        </aside>

        <main class="catalog">
            <h2>üì¶ √úr√ºn Kataloƒüu (Sim√ºlasyon Verisi)</h2>
            <p class="last-update">Son Etkile≈üim: <span id="update-time">Y√ºkleniyor...</span></p>

            <div id="category-tree">
                <section class="category">
                    <h3 style="color:#007bff;">+ ELECTRONICS</h3>
                    
                    <div class="subcategory">
                        <h4 style="color:#5aa5ff;">+ COMPUTERS</h4>
                        <div class="sub-subcategory">
                            <h5 style="color:#777;">+ LAPTOPS</h5>
                            <ul class="product-list">
                                <li class="product">
                                    <strong>Gamer Pro X (i9/32GB)</strong> 
                                    <span class="tag decorated">DECORATOR/DISCOUNT (20%)</span>
                                    <span class="price">$1199.99</span>
                                    <span class="stock low" data-stock="4">Stok: 4 (LOW)</span>
                                </li>
                                <li class="product">
                                    <strong>Business Ultra</strong>
                                    <span class="tag strategy">NORMAL PRICING</span>
                                    <span class="price" data-price="999.99">$999.99</span>
                                    <span class="stock" data-stock="8">Stok: 8</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="subcategory">
                        <h4 style="color:#5aa5ff;">+ PHONES</h4>
                        <ul class="product-list">
                            <li class="product">
                                <strong>Smartphone</strong>
                                <span class="tag decorated">DECORATOR/INCREASE (10%)</span>
                                <span class="price" data-price="879.99">$879.99</span>
                                <span class="stock" data-stock="15">Stok: 15</span>
                            </li>
                        </ul>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <footer>
        <p>&copy; 2024 Tasarƒ±m Desenleri Projesi | 6 Desen Entegre Edildi.</p>
    </footer>

    <script>
        const output = document.getElementById('backend-output');
        const catalogTree = document.getElementById('category-tree');
        let stockThreshold = 5; // Singleton sim√ºlasyonu i√ßin ba≈ülangƒ±√ß e≈üiƒüi

        function updateTime() {
            document.getElementById('update-time').innerText = new Date().toLocaleTimeString('tr-TR');
        }

        // Backend konsol √ßƒ±ktƒ±sƒ±nƒ± sim√ºle eder
        function log(message, type = 'info') {
            const p = document.createElement('p');
            p.className = `log-${type}`;
            p.innerHTML = `${new Date().toLocaleTimeString()} &gt; ${message}`;
            output.prepend(p); // En √ºste ekle
        }

        // Kataloƒüu sim√ºle edilmi≈ü bir veriye g√∂re g√ºnceller
        function simulateCatalogUpdate(newCatalogHTML) {
            catalogTree.innerHTML = newCatalogHTML;
            log('‚úÖ Katalog Backend verisiyle g√ºncellendi.', 'success');
            updateTime();
        }

        // Ana i≈ülem y√∂neticisi
        function handleMenu(choice, actionName) {
            log(`‚û°Ô∏è Se√ßilen ƒ∞≈ülem: ${actionName}`, 'action');

            if (choice === 9) {
                log('Sistem kapatƒ±lƒ±yor. Ho≈ü√ßa kalƒ±n! üëã', 'exit');
                return;
            }

            switch(choice) {
                case 1: // Yeni Kategori Ekle
                case 7: // √úr√ºn Sil
                case 8: // Kategori Sil
                    // Bu i≈ülemler i√ßin karma≈üƒ±k yol giri≈üi sim√ºle ediliyor
                    const path = prompt(`[${actionName}] L√ºtfen kategori yolunu (√∂r: 1.1) girin:`);
                    if (path) {
                        log(`‚öôÔ∏è Backend'e g√∂nderilen yol: ${path}`, 'info');
                    }
                    break;
                
                case 2: // Yeni √úr√ºn Ekle (Builder)
                    const builderChoice = prompt('[Builder] 1: Basit √úr√ºn (T-Shirt) / 2: Karma≈üƒ±k √úr√ºn (Laptop)');
                    if (builderChoice === '2') {
                         log('üîß Builder, Karma≈üƒ±k √úr√ºn√º olu≈üturuyor (Fiyat artƒ±≈üƒ± dahil).', 'success');
                    } else {
                         log('üè≠ Factory/Basit √úr√ºn olu≈üturuldu.', 'success');
                    }
                    break;

                case 3: // √úr√ºn/Stok/Fiyat G√ºncelle (Decorator & Observer)
                    const updateType = prompt('[√úr√ºn G√ºncelleme] 1: Fiyat G√ºncelle / 2: %10 Zam (Decorator) / 3: %20 ƒ∞ndirim (Decorator) / 4: Stok G√ºncelle');
                    if (updateType === '4') {
                        const oldStock = parseInt(prompt('[Observer] Mevcut stok:'));
                        const newStock = parseInt(prompt('[Observer] Yeni stok miktarƒ±nƒ± girin:'));
                        if (newStock < oldStock) {
                            log(`üìã STOK G√úNCELLEMESƒ∞: ${oldStock} -> ${newStock}`, 'info');
                            if (newStock <= stockThreshold) {
                                log(`‚ö†Ô∏è D√ú≈û√úK STOK UYARISI: Stok e≈üik (${stockThreshold}) altƒ±na d√º≈üt√º!`, 'error');
                            }
                        }
                    } else if (updateType === '2' || updateType === '3') {
                        log(`üéÅ Decorator (${updateType === '2' ? 'Zam' : 'ƒ∞ndirim'}) uygulandƒ±. Fiyat yeniden hesaplanacak.`, 'success');
                        // Ger√ßek Catalog'u hemen g√ºncelle
                        const oldPrice = parseFloat(catalogTree.querySelector('.price').getAttribute('data-price'));
                        const newPrice = updateType === '2' ? oldPrice * 1.10 : oldPrice * 0.80;
                        catalogTree.querySelector('.price').innerText = `$${newPrice.toFixed(2)}`;
                    }
                    break;

                case 5: // Fiyatlandƒ±rma Stratejisi Deƒüi≈ütir (Strategy)
                    const strategy = prompt('[Strategy] 1: Normal Fiyatlandƒ±rma / 2: Vergi Dahil Fiyatlandƒ±rma');
                    if (strategy === '2') {
                         log('üåê T√ºm √ºr√ºnlere Vergi Dahil Fiyatlandƒ±rma stratejisi uygulandƒ±.', 'success');
                         // Fiyatlarƒ± sim√ºle et (√ñrn: Business Ultra'ya %18 KDV ekle)
                         const buPriceElement = catalogTree.querySelector('li strong:contains("Business Ultra")').nextElementSibling.nextElementSibling;
                         const basePrice = parseFloat(buPriceElement.getAttribute('data-price')) || 999.99;
                         buPriceElement.innerText = `$${(basePrice * 1.18).toFixed(2)}`;
                    }
                    break;

                case 6: // D√º≈ü√ºk Stok E≈üiƒüi G√ºncelle (Singleton)
                    const newThreshold = parseInt(prompt('[Singleton] Yeni d√º≈ü√ºk stok e≈üiƒüini (≈üu anki: ' + stockThreshold + ') girin:'));
                    if (!isNaN(newThreshold)) {
                        stockThreshold = newThreshold;
                        log(`‚úÖ Singleton g√ºncellendi. Yeni e≈üik: ${stockThreshold}`, 'success');
                    }
                    break;

                case 4: // T√ºm Kataloƒüu G√∂r√ºnt√ºle
                    // Java √ßƒ±ktƒ±sƒ±nƒ± sim√ºle eden basit bir mesaj
                    log('üñºÔ∏è Katalog √ßƒ±ktƒ±sƒ± a≈üaƒüƒ±da g√ºncellendi.', 'info');
                    break;
            }
            updateTime();
        }
        
        // Basit String arama polyfill'i (IE desteƒüi i√ßin deƒüil, sadece kƒ±sa JS i√ßin)
        // Kaynak: https://stackoverflow.com/questions/8750808/how-to-use-queryselector-to-find-text-in-element-and-not-id-or-class-name
        if (!String.prototype.includes) {
            String.prototype.includes = function(search, start) {
                'use strict';
                if (typeof start !== 'number') {
                    start = 0;
                }
                return this.indexOf(search, start) !== -1;
            };
        }
        
        // DOM i√ßeriƒüi arama fonksiyonu
        (function (doc) {
            'use strict';
            Element.prototype.matches || (Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector);
            Element.prototype.closest || (Element.prototype.closest = function (selector) {
                var el = this;
                while (el) {
                    if (el.matches(selector)) {
                        return el;
                    }
                    el = el.parentElement;
                }
                return null;
            });
            var _qs = function (el, selector) {
                if (/:contains/.test(selector)) {
                    var matches = el.querySelectorAll(selector.split(':')[0]),
                        text = selector.match(/:contains\(['"](.+)['"]\)/)[1];
                    for (var i = 0, len = matches.length; i < len; i++) {
                        if (matches[i].textContent.includes(text)) {
                            return matches[i];
                        }
                    }
                    return null;
                }
                return el.querySelector(selector);
            };
            doc.querySelector = function (selector) {
                return _qs(doc, selector);
            };
        })(document.body.constructor.prototype.constructor.prototype);

        updateTime();
    </script>
    <style>
        /* Sadece JavaScript loglarƒ± i√ßin CSS */
        #backend-output {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 20px;
            background-color: #f9f9f9;
            border-radius: 4px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 0.85em;
            color: #333;
        }
        .log-info { color: #007bff; }
        .log-action { color: #5aa5ff; font-weight: bold; }
        .log-success { color: #28a745; }
        .log-error { color: #dc3545; font-weight: bold; }
        .log-exit { color: #6c757d; }
        #backend-output p { margin: 2px 0; }
        
        /* Ek Tag Stili */
        .tag.strategy { background-color: #4caf50; }
        .tag.decorated { background-color: #ff9800; }
        
        /* D√º≈ü√ºk Stok Uyarƒ±sƒ± */
        .stock.low {
            font-weight: bold;
            color: #f44336; 
            animation: blink 1s step-start infinite;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }
    </style>
</body>
</html>